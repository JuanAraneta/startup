<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.section{
text-align: center;
vertical-align: middle;
line-height: 90px;
}
#hidden{
  opacity: 0;
  transition: all .5s;
}
#hidden.show{
  opacity: 1;
}
</style>
<script>
setTimeout(function(){
  document.getElementById('hidden').classList = 'show';
}, 1000);

function getJoke() { 
  let config = {         
        url: "http://api.icndb.com/jokes/random"
        //Here you can add more config parameters
  };

  function resolve(xhttp) {
         let response = JSON.parse(event.target.response);
         document.getElementById('joke').innerHTML = response.value.joke;
         if (xhttp.readyState === XMLHttpRequest.DONE){
             if (xhttp.responseText.value){
                 document.getElementById("joke").innerHTML =xhttp.responseText.value.joke;
              }
          }
  };
  function reject() { 
      document.getElementById("joke").style.color = "red"; 
  };
    
  reusableRequest(config).then(resolve,reject); 

  function reusableRequest(object,resolve,reject){
      return new Promise( function (resolve, reject) {
        let xhttp = new XMLHttpRequest();
        xhttp.open("GET", object.url, true);
        xhttp.send();
        xhttp.onload = function () {
          if (this.status == 200) {
              resolve(xhttp);
          } else {
              reject(this.statusText);
          }
        };
        xhttp.onerror = function () {
          reject(this.statusText);
        };
      });   
  }
}
function searchRepo() {
    let xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
      if (this.readyState == 4 && this.status == 200) {
          console.log(xhttp.responseURL);
            let response = JSON.parse(event.target.response);
            document.getElementById("api").innerHTML = "";
            for(let i = 0; i < response.items.length; i++){
              document.getElementById("api").innerHTML += response.items[i].full_name+"<br>"

  }
        }
    };
    let search = document.getElementById("q").value;
    xhttp.open("GET", "https://api.github.com/search/repositories?q=" + search , true);
    xhttp.send();
  }

  function searchJSRepository() {
    let xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
      if (this.readyState == 4 && this.status == 200) {
          console.log(xhttp.responseURL);
            document.getElementById("api").innerHTML = "";
            document.getElementById("list").innerHTML = "";
            let response = JSON.parse(event.target.response);
            for(let i = 0; i < response.items.length; i++){
              let listElement = document.createElement("li");
              let data = document.createTextNode(response.items[i].full_name);
              listElement.appendChild(data);
              document.getElementById("list").appendChild(listElement);
            }
        }
    };
    xhttp.open("GET", "https://api.github.com/search/repositories?q='Javascript'", true);
    xhttp.send();
    }

function FadeIn(el2){
    let element2 = document.getElementById(el2);
    element2.style.transition = "1s opacity";
    element2.style.opacity = 1;                
}
</script>
	<title>Lesson 1</title>
</head>
<body>
  <h1>Lesson 1</h1>
	<section id="hidden" >Hello World!</section>
	<button onclick="getJoke()">Click here to laugh!</button>
  <section id="joke"></section>
  <hr>
  <input type="text" id="q" required="true"> 
  <button onclick="searchRepo()">Click here to search!</button>
  <div>
  <button onclick="searchJSRepository()">Click here to search "Javascript"!</button>
    <ul id="list">

    </ul>
  <section id="api"></section>
  </div>
</body>
</html>